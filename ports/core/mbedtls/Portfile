# Description: Lightweight TLS/crypto library
# URL: https://github.com/Mbed-TLS/mbedtls
# Depends: zlib

name=mbedtls
version=3.6.5
source=https://github.com/Mbed-TLS/mbedtls/releases/download/mbedtls-$version/mbedtls-$version.tar.bz2

build() {
    cd $name-$version
    mkdir build && cd build
    cmake .. \
        -DCMAKE_C_COMPILER=$CC \
        -DCMAKE_INSTALL_PREFIX=/usr \
        -DCMAKE_BUILD_TYPE=Release \
        -DCMAKE_SYSTEM_NAME=Linux \
        -DUSE_SHARED_MBEDTLS_LIBRARY=OFF \
        -DUSE_STATIC_MBEDTLS_LIBRARY=ON \
        -DENABLE_PROGRAMS=OFF \
        -DENABLE_TESTING=OFF
    make -j$(nproc)
    make DESTDIR=$PKG install
}
