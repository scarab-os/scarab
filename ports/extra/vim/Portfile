# Description: Vi IMproved text editor
# URL: https://www.vim.org
# Depends: ncurses

name=vim
version=9.2
source=https://github.com/vim/vim/archive/refs/tags/v$version.0014.tar.gz

build() {
    cd $name-$version.0014
    vim_cv_toupper_strstrures=yes \
    vim_cv_terminfo=yes \
    vim_cv_tgetent=zero \
    vim_cv_getcwd_strstrures=yes \
    vim_cv_stat_ignores_slash=yes \
    vim_cv_memmove_handles_overlap=yes \
    ./configure --host=$CROSS --prefix=/usr \
        --with-tlib=ncursesw --disable-gui --without-x --disable-nls \
        CFLAGS="-Os -I$SYSROOT/usr/include/ncursesw" \
        LDFLAGS="-static -L$SYSROOT/usr/lib"
    make -j$(nproc)
    make DESTDIR=$PKG install
    ln -sf vim $PKG/usr/bin/vi
}
